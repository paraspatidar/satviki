<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satviki Patidar | Indore | Neuro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <style>
        html { font-size: 16px; }
        body { overflow-x: hidden; color: #333; line-height: 1.6; background: #f8f9fa; }
        section { min-height: 100vh; width: 100%; padding: 60px 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        #hero { position: relative; display: flex; align-items: center; justify-content: center; color: white; text-align: center; background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)); }
        #hero::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('https://images.unsplash.com/photo-1507413245164-6160d8298b31?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'); background-size: cover; background-position: center; z-index: -1; }
        .hero-content { max-width: 800px; padding: 40px; background-color: rgba(0, 0, 0, 0.6); border-radius: 15px; animation: fadeIn 1.5s ease-in-out; }
        .hero-content h1 { font-size: 3.5rem; margin-bottom: 20px; font-weight: 700; }
        .hero-content p { font-size: 1.1rem; margin-bottom: 30px; opacity: 0.9; }
        #table-section { background-color: #f8f9fa; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .section-title { text-align: center; margin-bottom: 40px; font-size: 2.5rem; color: #2c3e50; position: relative; }
        .section-title::after { content: ''; display: block; width: 80px; height: 4px; background: #4CAF50; margin: 15px auto; border-radius: 2px; }
        #data-table { width: 100%; border-collapse: collapse; margin-top: 20px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); border-radius: 10px; overflow: hidden; animation: slideUp 1s ease-out; background: #fff; }
        #data-table th, #data-table td { padding: 15px 20px; text-align: left; border-bottom: 1px solid #e0e0e0; }
        #data-table th { background-color: #4CAF50; color: white; font-weight: 600; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px; }
        #data-table tr:nth-child(even) { background-color: #f2f2f2; }
        #data-table tr:last-child td { border-bottom: none; }
        #data-table tr:hover { background-color: #e9e9e9; }
        #gallery { background-color: #e9f5ff; padding: 60px 0; }
        .search-container { position: relative; display: flex; justify-content: center; margin-bottom: 25px; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto; }
        #search-bar { width: 100%; padding: 15px 25px; border: 2px solid #ddd; border-radius: 30px; font-size: 1rem; outline: none; transition: all 0.3s; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        #search-bar:focus { border-color: #4CAF50; box-shadow: 0 2px 15px rgba(76, 175, 80, 0.2); }
        .autocomplete-items { position: absolute; border: 1px solid #d4d4d4; border-bottom: none; border-top: none; z-index: 99; top: 100%; left: 0; right: 0; max-height: 200px; overflow-y: auto; border-radius: 0 0 10px 10px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); background-color: white; }
        .autocomplete-items div { padding: 12px 20px; cursor: pointer; background-color: #fff; border-bottom: 1px solid #d4d4d4; transition: background-color 0.2s; }
        .autocomplete-items div:hover { background-color: #f1f1f1; }
        .autocomplete-active { background-color: #4CAF50 !important; color: #ffffff; }
        .filter-buttons { display: flex; justify-content: center; margin-bottom: 30px; gap: 15px; flex-wrap: wrap; }
        .filter-btn { padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 30px; cursor: pointer; transition: all 0.3s; font-size: 0.95rem; font-weight: 500; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); }
        .filter-btn:hover { background-color: #45a049; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); }
        .filter-btn.active { background-color: #2E7D32; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2) inset; }
        .gallery-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 18px; padding: 20px; }
        .gallery-item { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); cursor: pointer; }
        .gallery-item:hover { transform: translateY(-10px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15); }
        .thumbnail, .gallery-item img { width: 100%; height: 180px; object-fit: cover; border-bottom: 1px solid #eee; }
        .pdf-thumbnail-container { width: 100%; height: 180px; background-color: #f8f8f8; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; overflow: hidden; border-bottom: 1px solid #eee; }
        .pdf-thumbnail { max-width: 100%; max-height: 100%; object-fit: contain; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .pdf-icon-overlay { position: absolute; bottom: 10px; right: 10px; background-color: rgba(231, 76, 60, 0.9); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .item-info { padding: 20px; text-align: center; }
        .item-info h3 { margin-bottom: 8px; color: #333; font-size: 1.1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .item-info p { color: #777; font-size: 0.9rem; font-weight: 500; }
        .folder-tag { display: inline-block; padding: 3px 8px; background-color: #e9f5ff; color: #2c3e50; border-radius: 4px; font-size: 0.8rem; margin-top: 5px; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100vw; height: 100vh; background-color: rgba(0, 0, 0, 0.95); overflow: auto; animation: fadeIn 0.3s; }
        .modal-content { margin: auto; display: block; max-width: 90vw; max-height: 80vh; margin-top: 5vh; animation: zoomIn 0.3s; box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3); border-radius: 5px; }
        #pdf-viewer-container { width: 100%; max-width: 900px; margin: 5vh auto 0 auto; background-color: #525659; box-shadow: 0 5px 30px rgba(0,0,0,0.3); position: relative; border-radius: 10px; padding: 20px 0 10px 0; }
        #pdf-canvas { display: block; margin: 0 auto; background: #fff; border-radius: 5px; max-width: 100vw; width: 100%; height: auto; box-shadow: 0 5px 30px rgba(0,0,0,0.3); }
        .close { position: fixed; top: 25px; right: 35px; color: white; font-size: 40px; font-weight: bold; cursor: pointer; transition: color 0.2s; z-index: 2000; background: rgba(0,0,0,0.5); border-radius: 50%; width: 48px; height: 48px; display: flex; align-items: center; justify-content: center; }
        .close:hover { color: #f1f1f1; background: rgba(0,0,0,0.8); }
        .caption { margin: 15px auto; display: block; width: 80%; text-align: center; color: #ccc; padding: 10px 0; font-size: 1.1rem; }
        .loading { display: flex; justify-content: center; align-items: center; height: 200px; font-size: 1.2rem; color: #777; }
        .spinner { border: 4px solid rgba(0, 0, 0, 0.1); border-radius: 50%; border-top: 4px solid #4CAF50; width: 40px; height: 40px; animation: spin 1s linear infinite; margin-right: 15px; }
        .pdf-controls { position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); background-color: rgba(0,0,0,0.85); padding: 10px 10px; border-radius: 30px; display: flex; gap: 10px; z-index: 1001; box-sizing: border-box; max-width: 98vw; overflow-x: auto; }
        .pdf-control-btn { background: none; border: none; color: white; font-size: 22px; cursor: pointer; padding: 10px 12px; border-radius: 8px; transition: background-color 0.2s; min-width: 44px; min-height: 44px; display: flex; align-items: center; justify-content: center; }
        .pdf-control-btn:active, .pdf-control-btn:focus { background-color: rgba(255,255,255,0.2); outline: none; }
        .zoom-level, #page-num { color: white; font-size: 18px; min-width: 50px; text-align: center; display: flex; align-items: center; justify-content: center; }
        .pdf-loading { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 1.2rem; text-align: center; }
        .pdf-loading .spinner { border: 4px solid rgba(255,255,255,0.3); border-radius: 50%; border-top: 4px solid #4CAF50; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes zoomIn { from { transform: scale(0.9); } to { transform: scale(1); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @media (max-width: 900px) {
            #pdf-viewer-container { max-width: 99vw; }
        }
        @media (max-width: 600px) {
            html { font-size: 14px; }
            section { padding: 30px 5px; }
            .hero-content { padding: 20px 5px; }
            .hero-content h1 { font-size: 2rem; }
            .hero-content p { font-size: 1rem; }
            .section-title { font-size: 1.5rem; }
            #data-table th, #data-table td { padding: 10px 8px; font-size: 0.9rem; }
            #data-table { font-size: 0.9rem; }
            .gallery-container { grid-template-columns: 1fr; gap: 10px; padding: 10px; }
            .thumbnail, .gallery-item img, .pdf-thumbnail-container { height: 120px; }
            #pdf-viewer-container {
                max-width: 100vw;
                margin: 0;
                border-radius: 0;
                padding: 10px 0 5px 0;
            }
            .modal-content { max-width: 99vw; max-height: 70vh; }
            .close { top: 10px; right: 10px; font-size: 32px; width: 38px; height: 38px; }
            .pdf-controls {
                bottom: 0;
                left: 0;
                right: 0;
                transform: none;
                border-radius: 0;
                max-width: 100vw;
                padding: 8px 2px;
                gap: 5px;
                justify-content: center;
            }
            .pdf-control-btn { font-size: 20px; min-width: 38px; min-height: 38px; }
            .zoom-level, #page-num { font-size: 15px; min-width: 36px; }
        }
        @media (max-width: 400px) {
            html { font-size: 12px; }
            .gallery-container { gap: 5px; }
            .thumbnail, .gallery-item img, .pdf-thumbnail-container { height: 80px; }
        }
    </style>
</head>
<body>
    <!-- First Section - Hero with Photo Background -->
    <section id="hero">
        <div class="hero-content">
            <h1>Satviki Patidar</h1>
            <p>Please use the search option to search specific report.</p>
            <p>You can select any specific category also for report/details by cliking that button like tissue-based, blood-based, MRI etc</p>
            <p>You may click on any report/image and zoom or download it , or close it and view others.</p>
            <p>At the end , there is a section for google drive folder which has some more files,dicom etc.</p>
            <p>Feel free to contact +91-8826533558 for any further details.</p>
        </div>
    </section>
    <!-- Second Section - Table -->
    <section id="table-section">
        <h3 class="section-title">Tissue Based Report Brief summary</h3>
        <table id="data-table">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Journal</th>
                    <th>Year</th>
                    <th>Category</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Blood Biomarkers in Early Detection</td>
                    <td>Journal of Hematology</td>
                    <td>2023</td>
                    <td>Blood-Based</td>
                </tr>
                <tr>
                    <td>Tissue Analysis Techniques</td>
                    <td>Pathology Research</td>
                    <td>2022</td>
                    <td>Tissue-Based</td>
                </tr>
                <tr>
                    <td>MRI Innovations in Diagnostics</td>
                    <td>Radiology Today</td>
                    <td>2023</td>
                    <td>MRI</td>
                </tr>
                <tr>
                    <td>Comprehensive Diagnostic Approaches</td>
                    <td>Medical Science Review</td>
                    <td>2021</td>
                    <td>Other</td>
                </tr>
                <tr>
                    <td>Circulating Tumor Cells Analysis</td>
                    <td>Oncology Research</td>
                    <td>2022</td>
                    <td>Blood-Based</td>
                </tr>
                <tr>
                    <td>Histopathological Patterns</td>
                    <td>Journal of Pathology</td>
                    <td>2023</td>
                    <td>Tissue-Based</td>
                </tr>
            </tbody>
        </table>
    </section>
    <!-- Third Section - Gallery -->
    <section id="gallery">
        <h2 class="section-title">Research Documents</h2>
        <div class="search-container">
            <input type="text" id="search-bar" placeholder="Search documents..." autocomplete="off">
            <div id="autocomplete-list" class="autocomplete-items"></div>
        </div>
        <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all">All Documents</button>
            <button class="filter-btn" data-filter="tissue-based">Tissue-Based</button>
            <button class="filter-btn" data-filter="blood-based">Blood-Based</button>
            <button class="filter-btn" data-filter="mri">MRI</button>
            <button class="filter-btn" data-filter="other">Other</button>
        </div>
        <div id="loading-state" class="loading">
            <div class="spinner"></div>
            <span>Loading documents from GitHub...</span>
        </div>
        <div class="gallery-container" id="gallery-container"></div>
    </section>
    <!-- Fourth Section - Google Drive Folder -->
    <section id="google-drive-folder" style="background-color: #ebeff2; padding: 60px 20px;">
      <div class="container">
        <h2 class="section-title">Google Drive Files</h2>
        <p style="text-align: center; margin-bottom: 30px; color: #2c3e50; font-size: 1.1rem;">
          Below is a view of additional files (e.g., DICOM, reports) stored in the public Google Drive folder.
        </p>
        <div style="display: flex; justify-content: center;">
          <iframe 
            src="https://drive.google.com/embeddedfolderview?id=1Z5QDCY0OsVRApW0kIwExpQVNNkrwQZiP#grid" 
            style="width: 100%; max-width: 1000px; height: 600px; border: 2px solid #4CAF50; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
          </iframe>
        </div>
      </div>
    </section>


    <!-- Modal for expanded view -->
    <div id="myModal" class="modal">
        <span class="close" id="modal-close-btn">&times;</span>
        <img class="modal-content" id="img01">
        <div id="pdf-viewer-container" style="display: none;">
            <div class="pdf-loading">
                <div class="spinner"></div>
                <p>Loading PDF document...</p>
            </div>
            <canvas id="pdf-canvas"></canvas>
        </div>
        <div class="pdf-controls" style="display: none;">
            <button class="pdf-control-btn" id="zoom-out"><i class="fas fa-search-minus"></i></button>
            <div class="zoom-level" id="zoom-level">100%</div>
            <button class="pdf-control-btn" id="zoom-in"><i class="fas fa-search-plus"></i></button>
            <button class="pdf-control-btn" id="prev-page"><i class="fas fa-arrow-left"></i></button>
            <div class="zoom-level" id="page-num">1/1</div>
            <button class="pdf-control-btn" id="next-page"><i class="fas fa-arrow-right"></i></button>
            <button class="pdf-control-btn" id="download-pdf"><i class="fas fa-download"></i></button>
        </div>
        <div id="caption" class="caption"></div>
    </div>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';
        const GITHUB_REPO = 'paraspatidar/satviki';
        const BRANCH = 'main';
        const ACCESS_TOKEN = '';
        const galleryContainer = document.getElementById('gallery-container');
        const loadingState = document.getElementById('loading-state');
        const modal = document.getElementById('myModal');
        const modalImg = document.getElementById('img01');
        const captionText = document.getElementById('caption');
        const closeBtn = document.getElementById('modal-close-btn');
        let pdfDoc = null, pageNum = 1, pageRendering = false, pageNumPending = null, scale = 1.0, maxScale = 3.0, minScale = 0.5;

        function isMobile() {
            return window.innerWidth <= 600 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        async function fetchDocumentsFromGitHub() {
            try {
                loadingState.style.display = 'flex';
                galleryContainer.innerHTML = '';
                const apiUrl = `https://api.github.com/repos/${GITHUB_REPO}/git/trees/${BRANCH}?recursive=1`;
                const headers = ACCESS_TOKEN ? { 'Authorization': `token ${ACCESS_TOKEN}` } : {};
                const response = await fetch(apiUrl, { headers });
                if (!response.ok) throw new Error('Failed to fetch repository structure');
                const data = await response.json();
                const targetFolders = ['tissue-based', 'blood-based', 'mri', 'other'];
                const allowedExtensions = ['.pdf', '.jpeg', '.jpg', '.png'];
                const documents = data.tree
                    .filter(item => {
                        const pathParts = item.path.split('/');
                        return pathParts.length === 2 && 
                               targetFolders.includes(pathParts[0]) && 
                               allowedExtensions.some(ext => item.path.endsWith(ext));
                    })
                    .map(item => {
                        const [folder, filename] = item.path.split('/');
                        const extension = filename.split('.').pop().toLowerCase();
                        const name = filename.replace(/\.[^/.]+$/, '').replace(/-/g, ' ').replace(/_/g, ' ');
                        return {
                            name: name,
                            folder: folder,
                            extension: extension,
                            rawUrl: `https://raw.githubusercontent.com/${GITHUB_REPO}/${BRANCH}/${item.path}`,
                            thumbnail: extension === 'pdf' ? 'pdf-icon' : 
                                     `https://raw.githubusercontent.com/${GITHUB_REPO}/${BRANCH}/${item.path}`
                        };
                    });
                initGallery(documents);
            } catch (error) {
                console.error('Error fetching documents:', error);
                galleryContainer.innerHTML = `
                    <div style="text-align: center; width: 100%; padding: 40px; color: #e74c3c;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <h3>Error loading documents</h3>
                        <p>${error.message}</p>
                        <p>Please check your GitHub repository configuration</p>
                    </div>
                `;
            } finally {
                loadingState.style.display = 'none';
            }
        }
        function initGallery(documents) {
            galleryContainer.innerHTML = '';
            documents.forEach(item => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                galleryItem.dataset.folder = item.folder;
                galleryItem.dataset.name = item.name.toLowerCase();
                let thumbnailContent;
                if (item.extension === 'pdf') {
                    thumbnailContent = `<div class="pdf-thumbnail-container" id="thumbnail-${item.name.replace(/\s+/g, '-')}"></div>`;
                } else {
                    thumbnailContent = `<img src="${item.thumbnail}" alt="${item.name}" class="thumbnail" loading="lazy">`;
                }
                galleryItem.innerHTML = `
                    ${thumbnailContent}
                    <div class="item-info">
                        <h3>${item.name}</h3>
                        <p>${item.extension.toUpperCase()} File</p>
                        <div class="folder-tag">${item.folder.replace('-', ' ')}</div>
                    </div>
                `;
                galleryItem.addEventListener('click', () => openModal(item));
                galleryContainer.appendChild(galleryItem);
                if (item.extension === 'pdf') {
                    const container = galleryItem.querySelector('.pdf-thumbnail-container');
                    generatePdfThumbnail(item.rawUrl, container);
                }
            });
            initSearchAndFilter();
        }
        async function generatePdfThumbnail(pdfUrl, container) {
            try {
                const loadingTask = pdfjsLib.getDocument(pdfUrl);
                const pdf = await loadingTask.promise;
                const page = await pdf.getPage(1);
                const viewport = page.getViewport({ scale: 0.5 });
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                await page.render({ canvasContext: context, viewport: viewport }).promise;
                canvas.classList.add('pdf-thumbnail');
                container.innerHTML = '';
                container.appendChild(canvas);
                const iconOverlay = document.createElement('div');
                iconOverlay.classList.add('pdf-icon-overlay');
                iconOverlay.innerHTML = '<i class="fas fa-file-pdf"></i>';
                container.appendChild(iconOverlay);
            } catch (error) {
                container.innerHTML = `
                    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;">
                        <i class="fas fa-file-pdf" style="font-size: 50px; color: #e74c3c;"></i>
                        <span style="margin-top: 10px; font-size: 14px; color: #777;">PDF Document</span>
                    </div>
                `;
            }
        }
        function initSearchAndFilter() {
            let currentFocus = -1;
            document.getElementById('search-bar').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
                const autocompleteList = document.getElementById('autocomplete-list');
                autocompleteList.innerHTML = '';
                currentFocus = -1;
                if (searchTerm.length > 0) {
                    const uniqueSuggestions = new Set();
                    const items = document.querySelectorAll('.gallery-item');
                    items.forEach(item => {
                        const name = item.dataset.name;
                        const folder = item.dataset.folder;
                        if (name.includes(searchTerm)) {
                            if (activeFilter === 'all' || folder === activeFilter) {
                                uniqueSuggestions.add(item.querySelector('h3').textContent);
                            }
                        }
                    });
                    const sortedSuggestions = Array.from(uniqueSuggestions).sort();
                    sortedSuggestions.forEach(suggestion => {
                        const suggestionElement = document.createElement('div');
                        suggestionElement.innerHTML = `<strong>${suggestion.substr(0, searchTerm.length)}</strong>${suggestion.substr(searchTerm.length)}`;
                        suggestionElement.innerHTML += `<input type='hidden' value='${suggestion}'>`;
                        suggestionElement.addEventListener('click', function() {
                            document.getElementById('search-bar').value = suggestion;
                            autocompleteList.innerHTML = '';
                            filterItems(suggestion, activeFilter);
                        });
                        autocompleteList.appendChild(suggestionElement);
                    });
                }
                filterItems(searchTerm, activeFilter);
            });
            document.getElementById('search-bar').addEventListener('keydown', function(e) {
                const autocompleteList = document.getElementById('autocomplete-list');
                const items = autocompleteList.children;
                if (e.key === 'ArrowDown') {
                    currentFocus++;
                    addActive(items);
                } else if (e.key === 'ArrowUp') {
                    currentFocus--;
                    addActive(items);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (currentFocus > -1 && items.length > 0) {
                        if (items[currentFocus]) {
                            items[currentFocus].click();
                        }
                    }
                }
            });
            function addActive(items) {
                if (!items) return false;
                removeActive(items);
                if (currentFocus >= items.length) currentFocus = 0;
                if (currentFocus < 0) currentFocus = (items.length - 1);
                if (items[currentFocus]) {
                    items[currentFocus].classList.add('autocomplete-active');
                    items[currentFocus].scrollIntoView({ block: 'nearest' });
                }
            }
            function removeActive(items) {
                for (let i = 0; i < items.length; i++) {
                    items[i].classList.remove('autocomplete-active');
                }
            }
            document.addEventListener('click', function(e) {
                if (e.target.id !== 'search-bar') {
                    document.getElementById('autocomplete-list').innerHTML = '';
                }
            });
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    const filterType = this.dataset.filter;
                    const searchTerm = document.getElementById('search-bar').value.toLowerCase();
                    filterItems(searchTerm, filterType);
                });
            });
        }
        function filterItems(searchTerm, filterType) {
            const items = document.querySelectorAll('.gallery-item');
            items.forEach(item => {
                const name = item.dataset.name;
                const folder = item.dataset.folder;
                const matchesSearch = name.includes(searchTerm.toLowerCase());
                const matchesFilter = filterType === 'all' || folder === filterType;
                if (matchesSearch && matchesFilter) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        function openModal(item) {
            modal.style.display = "block";
            captionText.innerHTML = item.name;
            if (item.extension === 'pdf') {
                modalImg.style.display = "none";
                document.getElementById('pdf-viewer-container').style.display = "block";
                document.querySelector('.pdf-controls').style.display = "flex";
                loadPdf(item.rawUrl);
                document.getElementById('download-pdf').onclick = function() {
                    window.open(item.rawUrl, '_blank');
                };
            } else {
                modalImg.src = item.rawUrl;
                modalImg.style.display = "block";
                document.getElementById('pdf-viewer-container').style.display = "none";
                document.querySelector('.pdf-controls').style.display = "none";
            }
        }
        function loadPdf(url) {
            document.querySelector('.pdf-loading').style.display = 'block';
            document.getElementById('pdf-canvas').style.display = 'none';
            pageNum = 1;
            scale = isMobile() ? 1.6 : 1.0;
            pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
                pdfDoc = pdfDoc_;
                document.getElementById('page-num').textContent = `1/${pdfDoc.numPages}`;
                document.querySelector('.pdf-loading').style.display = 'none';
                document.getElementById('pdf-canvas').style.display = 'block';
                renderPage(pageNum);
            }).catch(function(error) {
                document.querySelector('.pdf-loading').innerHTML = `
                    <div style="color: #ff6b6b;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Error loading PDF</p>
                    </div>
                `;
            });
        }
        function renderPage(num) {
            pageRendering = true;
            pdfDoc.getPage(num).then(function(page) {
                const viewport = page.getViewport({ scale: scale });
                const canvas = document.getElementById('pdf-canvas');
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                const renderContext = { canvasContext: context, viewport: viewport };
                const renderTask = page.render(renderContext);
                renderTask.promise.then(function() {
                    pageRendering = false;
                    if (pageNumPending !== null) {
                        renderPage(pageNumPending);
                        pageNumPending = null;
                    }
                });
            });
            document.getElementById('page-num').textContent = `${num}/${pdfDoc.numPages}`;
            document.getElementById('zoom-level').textContent = `${Math.round(scale * 100)}%`;
        }
        function queueRenderPage(num) {
            if (pageRendering) {
                pageNumPending = num;
            } else {
                renderPage(num);
            }
        }
        function closeModal() {
            modal.style.display = "none";
            document.getElementById('pdf-viewer-container').style.display = "none";
            document.querySelector('.pdf-controls').style.display = "none";
            if (pdfDoc) {
                pdfDoc.destroy();
                pdfDoc = null;
            }
        }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && modal.style.display === 'block') {
                closeModal();
            }
        });
        closeBtn.onclick = closeModal;
        modal.addEventListener('mousedown', function(e) {
            if (e.target === modal) closeModal();
        });
        document.getElementById('prev-page').addEventListener('click', function() {
            if (pageNum <= 1) return;
            pageNum--;
            queueRenderPage(pageNum);
        });
        document.getElementById('next-page').addEventListener('click', function() {
            if (pageNum >= pdfDoc.numPages) return;
            pageNum++;
            queueRenderPage(pageNum);
        });
        document.getElementById('zoom-in').addEventListener('click', function() {
            if (scale >= maxScale) return;
            scale += 0.1;
            renderPage(pageNum);
        });
        document.getElementById('zoom-out').addEventListener('click', function() {
            if (scale <= minScale) return;
            scale -= 0.1;
            renderPage(pageNum);
        });
        window.onload = fetchDocumentsFromGitHub;
    </script>
</body>
</html>
